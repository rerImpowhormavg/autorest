{
  "swagger": "2.0",
  "info": {
    "version": "1.0",
    "title": "Yammer Connector"
  },
  "host": "localhost:64884",
  "schemes": [
    "http"
  ],
  "paths": {
    "/PostMessage": {
      "post": {
        "tags": [
          "YammerConnector"
        ],
        "summary": "Posts a message with topic(optional) with attachment(optional) to a particular group/user's own feed\r\n            Also provides the ability to tag yammer users in the message post",
        "operationId": "PostToYammer",
        "consumes": [
          "application/json",
          "text/json"
        ],
        "produces": [
          "application/json",
          "text/json"
        ],
        "parameters": [
          {
            "name": "input",
            "in": "body",
            "description": "post request of type YammerRequest",
            "required": true,
            "schema": {
              "$ref": "#/definitions/PostOperationRequest"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Created",
            "schema": {
              "$ref": "#/definitions/PostOperationResponse"
            }
          },
          "400": {
            "description": "Bad Request"
          },
          "408": {
            "description": "Request Timeout"
          },
          "429": {
            "description": "Too Many Requests"
          },
          "500": {
            "description": "Internal Server Error. Unknown error occured"
          },
          "503": {
            "description": "Yammer Service Unavailable"
          },
          "504": {
            "description": "Gateway Timeout"
          },
          "default": {
            "description": "Created",
            "schema": {
              "$ref": "#/definitions/PostOperationResponse"
            }
          }
        },
        "deprecated": false
      }
    },
    "/GetMessageFromGroup": {
      "get": {
        "tags": [
          "YammerConnector"
        ],
        "summary": "Retrieves a Yammer post from the group specified",
        "operationId": "TriggerGetMessageFromGroup",
        "consumes": [
          
        ],
        "produces": [
          "application/json",
          "text/json"
        ],
        "parameters": [
          {
            "name": "triggerState",
            "in": "query",
            "description": "trigger state",
            "required": true,
            "type": "string"
          },
          {
            "name": "groupId",
            "in": "query",
            "description": "Group Id",
            "required": true,
            "type": "integer",
            "format": "int32"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          },
          "202": {
            "description": "Accepted"
          },
          "400": {
            "description": "Bad Request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "408": {
            "description": "Request Timeout"
          },
          "429": {
            "description": "Too Many Requests"
          },
          "500": {
            "description": "Internal Server Error. Unknown error occured"
          },
          "503": {
            "description": "Yammer Service Unavailable"
          },
          "504": {
            "description": "Gateway Timeout"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          }
        },
        "deprecated": false
      }
    },
    "/GetMessageFromFollowingFeed": {
      "get": {
        "tags": [
          "YammerConnector"
        ],
        "summary": "Retrieves a Yammer post from Yammer Following feed",
        "operationId": "TriggerGetMessageFromFollowingFeed",
        "consumes": [
          
        ],
        "produces": [
          "application/json",
          "text/json"
        ],
        "parameters": [
          {
            "name": "triggerState",
            "in": "query",
            "description": "trigger state",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          },
          "202": {
            "description": "Accepted"
          },
          "400": {
            "description": "Bad Request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "408": {
            "description": "Request Timeout"
          },
          "429": {
            "description": "Too Many Requests"
          },
          "500": {
            "description": "Internal Server Error. Unknown error occured"
          },
          "503": {
            "description": "Yammer Service Unavailable"
          },
          "504": {
            "description": "Gateway Timeout"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          }
        },
        "deprecated": false
      }
    },
    "/GetMessageFromAllCompanyFeed": {
      "get": {
        "tags": [
          "YammerConnector"
        ],
        "summary": "Retrieves a Yammer post from Yammer All Company Feed",
        "operationId": "TriggerGetMessageFromAllCompanyFeed",
        "consumes": [
          
        ],
        "produces": [
          "application/json",
          "text/json"
        ],
        "parameters": [
          {
            "name": "triggerState",
            "in": "query",
            "description": "Trigger state",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          },
          "202": {
            "description": "Accepted"
          },
          "400": {
            "description": "Bad Request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "408": {
            "description": "Request Timeout"
          },
          "429": {
            "description": "Too Many Requests"
          },
          "500": {
            "description": "Internal Server Error. Unknown error occured"
          },
          "503": {
            "description": "Yammer Service Unavailable"
          },
          "504": {
            "description": "Gateway Timeout"
          },
          "default": {
            "description": "OK",
            "schema": {
              "$ref": "#/definitions/GetOperationResponse"
            }
          }
        },
        "deprecated": false
      }
    }
  },
  "definitions": {
    "PostOperationRequest": {
      "description": "Represents a post request for Yammer Connector to post to yammer",
      "required": [
        "Body"
      ],
      "type": "object",
      "properties": {
        "Body": {
          "description": "body of the post",
          "type": "string"
        },
        "GroupId": {
          "description": "group Id to post to. If not specified, message is posted to All Company feed",
          "type": "string"
        },
        "Topics": {
          "description": "list of topics associated with the post",
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "Attachments": {
          "description": "list of attachments associated with the post",
          "type": "array",
          "items": {
            "$ref": "YammerAttachment"
          }
        },
        "TagUserPermalinks": {
          "description": "This property can be used for tagging other yammer users in your message post (similar to using '@' in yammer/facebook)\r\n            list of network names (unique to that network) with which the users would have created network on Yammer.\r\n            This can be found embedded in the URL of user's profile page",
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "YammerAttachment": {
      "description": "Represents an attachment in Yammer",
      "required": [
        "ContentData",
        "ContentType",
        "ContentTransferEncoding"
      ],
      "type": "object",
      "properties": {
        "FileName": {
          "description": "Gets or sets file name of the attachment",
          "type": "string"
        },
        "ContentData": {
          "type": "string"
        },
        "ContentType": {
          "type": "string"
        },
        "ContentTransferEncoding": {
          "type": "string"
        }
      }
    },
    "PostOperationResponse": {
      "description": "Represents response of post operation of Yammer Connector for posting to yammer",
      "type": "object",
      "properties": {
        "CreatedAt": {
          "description": "timestamp for the post",
          "type": "string"
        },
        "Id": {
          "description": "Id associated with that post",
          "type": "string"
        }
      }
    },
    "GetOperationResponse": {
      "description": "Response Class for Get Operation",
      "type": "object",
      "properties": {
        "MessageId": {
          "format": "int32",
          "description": "Id associated with the post",
          "type": "integer"
        },
        "MessageBody": {
          "description": "Text Content of the post",
          "type": "string"
        },
        "SenderDetails": {
          "$ref": "User",
          "description": "Details of user who posted the message"
        },
        "CreatedAt": {
          "description": "Created at time of the post",
          "type": "string"
        },
        "WebUrl": {
          "description": "Web url of the post",
          "type": "string"
        },
        "NotifiedUsersDetails": {
          "description": "Details of users notified",
          "type": "array",
          "items": {
            "$ref": "User"
          }
        },
        "Attachments": {
          "description": "Attachments associated with the post",
          "type": "array",
          "items": {
            "$ref": "YammerAttachment"
          }
        },
        "IsSystemMessage": {
          "description": "Flag to specify if the post is a system generated message or not",
          "type": "boolean"
        }
      }
    },
    "User": {
      "description": "",
      "type": "object",
      "properties": {
        "UserId": {
          "format": "int32",
          "description": "Id associated with the user",
          "type": "integer"
        },
        "UserPermalink": {
          "description": "Permalink of the user : network name (unique to that network) with which the user would have created network on Yammer.\r\n            This can be found embedded in the URL of user's profile page",
          "type": "string"
        },
        "Name": {
          "description": "Name of the user",
          "type": "string"
        }
      }
    }
  }
}